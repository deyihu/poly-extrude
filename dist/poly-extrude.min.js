/*!
 * poly-extrude v0.2.0
  */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).polyextrude=t.polyextrude||{})}(this,(function(t){"use strict";var n={exports:{}};function r(t,n,r){r=r||2;var e,o,h,a,u,x,p,f=n&&n.length,y=f?n[0]*r:t.length,d=i(t,0,y,r,!0),g=[];if(!d||d.next===d.prev)return g;if(f&&(d=function(t,n,r,e){var s,o,h,a=[];for(s=0,o=n.length;s<o;s++)(h=i(t,n[s]*e,s<o-1?n[s+1]*e:t.length,e,!1))===h.next&&(h.steiner=!0),a.push(v(h));for(a.sort(c),s=0;s<a.length;s++)r=l(a[s],r);return r}(t,n,d,r)),t.length>80*r){e=h=t[0],o=a=t[1];for(var z=r;z<y;z+=r)(u=t[z])<e&&(e=u),(x=t[z+1])<o&&(o=x),u>h&&(h=u),x>a&&(a=x);p=0!==(p=Math.max(h-e,a-o))?32767/p:0}return s(d,g,r,e,o,p,0),g}function i(t,n,r,i,e){var s,o;if(e===V(t,n,r,i)>0)for(s=n;s<r;s+=i)o=P(s,t[s],t[s+1],o);else for(s=r-i;s>=n;s-=i)o=P(s,t[s],t[s+1],o);return o&&g(o,o.next)&&(S(o),o=o.next),o}function e(t,n){if(!t)return t;n||(n=t);var r,i=t;do{if(r=!1,i.steiner||!g(i,i.next)&&0!==d(i.prev,i,i.next))i=i.next;else{if(S(i),(i=n=i.prev)===i.next)break;r=!0}}while(r||i!==n);return n}function s(t,n,r,i,c,l,x){if(t){!x&&l&&function(t,n,r,i){var e=t;do{0===e.z&&(e.z=p(e.x,e.y,n,r,i)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next}while(e!==t);e.prevZ.nextZ=null,e.prevZ=null,function(t){var n,r,i,e,s,o,h,a,u=1;do{for(r=t,t=null,s=null,o=0;r;){for(o++,i=r,h=0,n=0;n<u&&(h++,i=i.nextZ);n++);for(a=u;h>0||a>0&&i;)0!==h&&(0===a||!i||r.z<=i.z)?(e=r,r=r.nextZ,h--):(e=i,i=i.nextZ,a--),s?s.nextZ=e:t=e,e.prevZ=s,s=e;r=i}s.nextZ=null,u*=2}while(o>1)}(e)}(t,i,c,l);for(var v,f,y=t;t.prev!==t.next;)if(v=t.prev,f=t.next,l?h(t,i,c,l):o(t))n.push(v.i/r|0),n.push(t.i/r|0),n.push(f.i/r|0),S(t),t=f.next,y=f.next;else if((t=f)===y){x?1===x?s(t=a(e(t),n,r),n,r,i,c,l,2):2===x&&u(t,n,r,i,c,l):s(e(t),n,r,i,c,l,1);break}}}function o(t){var n=t.prev,r=t,i=t.next;if(d(n,r,i)>=0)return!1;for(var e=n.x,s=r.x,o=i.x,h=n.y,a=r.y,u=i.y,c=e<s?e<o?e:o:s<o?s:o,l=h<a?h<u?h:u:a<u?a:u,x=e>s?e>o?e:o:s>o?s:o,p=h>a?h>u?h:u:a>u?a:u,v=i.next;v!==n;){if(v.x>=c&&v.x<=x&&v.y>=l&&v.y<=p&&f(e,h,s,a,o,u,v.x,v.y)&&d(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function h(t,n,r,i){var e=t.prev,s=t,o=t.next;if(d(e,s,o)>=0)return!1;for(var h=e.x,a=s.x,u=o.x,c=e.y,l=s.y,x=o.y,v=h<a?h<u?h:u:a<u?a:u,y=c<l?c<x?c:x:l<x?l:x,g=h>a?h>u?h:u:a>u?a:u,z=c>l?c>x?c:x:l>x?l:x,m=p(v,y,n,r,i),M=p(g,z,n,r,i),w=t.prevZ,b=t.nextZ;w&&w.z>=m&&b&&b.z<=M;){if(w.x>=v&&w.x<=g&&w.y>=y&&w.y<=z&&w!==e&&w!==o&&f(h,c,a,l,u,x,w.x,w.y)&&d(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,b.x>=v&&b.x<=g&&b.y>=y&&b.y<=z&&b!==e&&b!==o&&f(h,c,a,l,u,x,b.x,b.y)&&d(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;w&&w.z>=m;){if(w.x>=v&&w.x<=g&&w.y>=y&&w.y<=z&&w!==e&&w!==o&&f(h,c,a,l,u,x,w.x,w.y)&&d(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;b&&b.z<=M;){if(b.x>=v&&b.x<=g&&b.y>=y&&b.y<=z&&b!==e&&b!==o&&f(h,c,a,l,u,x,b.x,b.y)&&d(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function a(t,n,r){var i=t;do{var s=i.prev,o=i.next.next;!g(s,o)&&z(s,i,i.next,o)&&w(s,o)&&w(o,s)&&(n.push(s.i/r|0),n.push(i.i/r|0),n.push(o.i/r|0),S(i),S(i.next),i=t=o),i=i.next}while(i!==t);return e(i)}function u(t,n,r,i,o,h){var a=t;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&y(a,u)){var c=b(a,u);return a=e(a,a.next),c=e(c,c.next),s(a,n,r,i,o,h,0),void s(c,n,r,i,o,h,0)}u=u.next}a=a.next}while(a!==t)}function c(t,n){return t.x-n.x}function l(t,n){var r=function(t,n){var r,i=n,e=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var h=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(h<=e&&h>o&&(o=h,r=i.x<i.next.x?i:i.next,h===e))return r}i=i.next}while(i!==n);if(!r)return null;var a,u=r,c=r.x,l=r.y,p=1/0;i=r;do{e>=i.x&&i.x>=c&&e!==i.x&&f(s<l?e:o,s,c,l,s<l?o:e,s,i.x,i.y)&&(a=Math.abs(s-i.y)/(e-i.x),w(i,t)&&(a<p||a===p&&(i.x>r.x||i.x===r.x&&x(r,i)))&&(r=i,p=a)),i=i.next}while(i!==u);return r}(t,n);if(!r)return n;var i=b(r,t);return e(i,i.next),e(r,r.next)}function x(t,n){return d(t.prev,t,n.prev)<0&&d(n.next,t,t.next)<0}function p(t,n,r,i,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*e|0)|t<<8))|t<<4))|t<<2))|t<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*e|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function v(t){var n=t,r=t;do{(n.x<r.x||n.x===r.x&&n.y<r.y)&&(r=n),n=n.next}while(n!==t);return r}function f(t,n,r,i,e,s,o,h){return(e-o)*(n-h)>=(t-o)*(s-h)&&(t-o)*(i-h)>=(r-o)*(n-h)&&(r-o)*(s-h)>=(e-o)*(i-h)}function y(t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!function(t,n){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==n.i&&r.next.i!==n.i&&z(r,r.next,t,n))return!0;r=r.next}while(r!==t);return!1}(t,n)&&(w(t,n)&&w(n,t)&&function(t,n){var r=t,i=!1,e=(t.x+n.x)/2,s=(t.y+n.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&e<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==t);return i}(t,n)&&(d(t.prev,t,n.prev)||d(t,n.prev,n))||g(t,n)&&d(t.prev,t,t.next)>0&&d(n.prev,n,n.next)>0)}function d(t,n,r){return(n.y-t.y)*(r.x-n.x)-(n.x-t.x)*(r.y-n.y)}function g(t,n){return t.x===n.x&&t.y===n.y}function z(t,n,r,i){var e=M(d(t,n,r)),s=M(d(t,n,i)),o=M(d(r,i,t)),h=M(d(r,i,n));return e!==s&&o!==h||(!(0!==e||!m(t,r,n))||(!(0!==s||!m(t,i,n))||(!(0!==o||!m(r,t,i))||!(0!==h||!m(r,n,i)))))}function m(t,n,r){return n.x<=Math.max(t.x,r.x)&&n.x>=Math.min(t.x,r.x)&&n.y<=Math.max(t.y,r.y)&&n.y>=Math.min(t.y,r.y)}function M(t){return t>0?1:t<0?-1:0}function w(t,n){return d(t.prev,t,t.next)<0?d(t,n,t.next)>=0&&d(t,t.prev,n)>=0:d(t,n,t.prev)<0||d(t,t.next,n)<0}function b(t,n){var r=new A(t.i,t.x,t.y),i=new A(n.i,n.x,n.y),e=t.next,s=n.prev;return t.next=n,n.prev=t,r.next=e,e.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function P(t,n,r,i){var e=new A(t,n,r);return i?(e.next=i.next,e.prev=i,i.next.prev=e,i.next=e):(e.prev=e,e.next=e),e}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function A(t,n,r){this.i=t,this.x=n,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function V(t,n,r,i){for(var e=0,s=n,o=r-i;s<r;s+=i)e+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return e}n.exports=r,n.exports.default=r,r.deviation=function(t,n,r,i){var e=n&&n.length,s=e?n[0]*r:t.length,o=Math.abs(V(t,0,s,r));if(e)for(var h=0,a=n.length;h<a;h++){var u=n[h]*r,c=h<a-1?n[h+1]*r:t.length;o-=Math.abs(V(t,u,c,r))}var l=0;for(h=0;h<i.length;h+=3){var x=i[h]*r,p=i[h+1]*r,v=i[h+2]*r;l+=Math.abs((t[x]-t[v])*(t[p+1]-t[x+1])-(t[x]-t[p])*(t[v+1]-t[x+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},r.flatten=function(t){for(var n=t[0][0].length,r={vertices:[],holes:[],dimensions:n},i=0,e=0;e<t.length;e++){for(var s=0;s<t[e].length;s++)for(var o=0;o<n;o++)r.vertices.push(t[e][s][o]);e>0&&(i+=t[e-1].length,r.holes.push(i))}return r};var Z=n.exports;function _(t){for(var n,r,i=0,e=1,s=t.length;e<s;)n=r||t[0],i+=((r=t[e])[0]-n[0])*(r[1]+n[1]),e++;return i>0}function L(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t}function F(t,n){var r=n[0],i=n[1],e=n[2],s=Math.sqrt(r*r+i*i+e*e)||1;return t[0]=r/s,t[1]=i/s,t[2]=e/s,t}function O(t,n){function r(t,n,r,i){t[0]=n,t[1]=r,t[2]=i}for(var i,e,s,o,h,a,u,c,l,x=[],p=[],v=[],f=[],y=[],d=[],g=t.length,z=new Float32Array(n.length),m=0;m<g;){var M=3*t[m],w=3*t[m+1],b=3*t[m+2];r(x,n[M],n[M+1],n[M+2]),r(p,n[w],n[w+1],n[w+2]),r(v,n[b],n[b+1],n[b+2]),L(y,v,p),L(f,x,p),i=d,s=f,o=void 0,h=void 0,a=void 0,u=void 0,c=void 0,l=void 0,o=(e=y)[0],h=e[1],a=e[2],u=s[0],c=s[1],l=s[2],i[0]=h*l-a*c,i[1]=a*u-o*l,i[2]=o*c-h*u;for(var P=0;P<3;P++)z[M+P]+=d[P],z[w+P]+=d[P],z[b+P]+=d[P];m+=3}for(var S=0,A=z.length;S<A;)r(d,z[S],z[S+1],z[S+2]),F(d,d),z[S]=d[0]||0,z[S+1]=d[1]||0,z[S+2]=d[2]||0,S+=3;return z}function I(t){if(1===t.length)return{position:t[0].position,normal:t[0].normal,uv:t[0].uv,indices:t[0].indices,results:t};for(var n=0,r=0,i=0,e=t.length;i<e;i++){var s=t[i],o=s.position,h=s.indices;n+=o.length,r+=h.length}for(var a={position:new Float32Array(n),normal:new Float32Array(n),uv:new Float32Array(n/3*2),indices:new Uint32Array(r),results:t},u=0,c=0,l=0,x=0,p=0,v=t.length;p<v;p++){var f=t[p],y=f.position,d=f.indices,g=f.normal,z=f.uv;a.position.set(y,u),a.normal.set(g,u),a.uv.set(z,x);for(var m=0,M=d.length;m<M;){var w=d[m]+c;a.indices[l]=w,l++,m++}x+=z.length,u+=y.length,c+=y.length/3}return a}function q(t){return 180*t/Math.PI}function U(t){return t/180*Math.PI}function j(t,n,r,i,e,s){var o=3*r,h=3*i,a=3*e,u=3*s,c=n[o],l=n[o+1],x=n[o+2],p=n[h],v=n[h+1],f=n[h+2],y=n[a],d=n[a+1],g=n[a+2],z=n[u],m=n[u+1],M=n[u+2];Math.abs(l-v)<Math.abs(c-p)?(t.push(c,1-x),t.push(p,1-f),t.push(y,1-g),t.push(z,1-M)):(t.push(l,1-x),t.push(v,1-f),t.push(d,1-g),t.push(m,1-M))}function C(t){T(t)||t.push(t[0])}function T(t){var n=t.length,r=t[0],i=r[0],e=r[1],s=t[n-1],o=s[0],h=s[1];return i===o&&e===h}var k={x:0,y:0},B={x:0,y:0};function R(t,n){for(var r=0,i=n.lineWidth/2,e=[],s=[],o=[],h=t.length,a=0;a<h-1;){var u=t[a],c=t[a+1],l=c[1]-u[1],x=c[0]-u[0],p=0,v=q(Math.atan(l/x));if(r=v,0===a)p=v,p-=90;else{var f=t[a-1];k.x=f[0]-u[0],k.y=f[1]-u[1],B.x=c[0]-u[0],B.y=c[1]-u[1],p=v-N(k,B)/2}var y=E(U(p),i,u),d=y[0],g=y[1];e.push(d,g),W(d,u,c)?(s.push(d),o.push(g)):(s.push(g),o.push(d)),a++}var z=r,m=U(z-=90),M=t[h-2],w=t[h-1],b=E(m,i,w),P=b[0],S=b[1];return e.push(P,S),W(P,M,w)?(s.push(P),o.push(S)):(s.push(S),o.push(P)),{offsetPoints:e,leftPoints:s,rightPoints:o}}function E(t,n,r){var i=r[0],e=r[1],s=r[2]||0,o=[i+Math.cos(t)*n,e+Math.sin(t)*n,s],h=t+=Math.PI;return[o,[i+Math.cos(h)*n,e+Math.sin(h)*n,s]]}var N=function(t,n){var r=t.x,i=t.y,e=n.x,s=n.y,o=r*e+i*s,h=r*s-i*e;return(Math.atan2(h,o)/Math.PI*180+360)%360};function W(t,n,r){var i=n[0],e=n[1],s=r[0],o=r[1];return(e-o)*t[0]+(s-i)*t[1]+i*o-s*e>0}var D=function(){function t(t,n,r){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=t,this.y=n,this.z=r}var n=t.prototype;return n.set=function(t,n,r){return void 0===r&&(r=this.z),this.x=t,this.y=n,this.z=r,this},n.clone=function(){return new this.constructor(this.x,this.y,this.z)},n.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},n.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},n.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},n.addVectors=function(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this},n.addScaledVector=function(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this},n.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},n.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},n.subVectors=function(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this},n.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},n.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},n.multiplyVectors=function(t,n){return this.x=t.x*n.x,this.y=t.y*n.y,this.z=t.z*n.z,this},n.applyMatrix4=function(t){var n=this.x,r=this.y,i=this.z,e=t.elements,s=1/(e[3]*n+e[7]*r+e[11]*i+e[15]);return this.x=(e[0]*n+e[4]*r+e[8]*i+e[12])*s,this.y=(e[1]*n+e[5]*r+e[9]*i+e[13])*s,this.z=(e[2]*n+e[6]*r+e[10]*i+e[14])*s,this},n.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},n.divideScalar=function(t){return this.multiplyScalar(1/t)},n.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},n.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},n.clamp=function(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this},n.clampScalar=function(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this},n.clampLength=function(t,n){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(n,r)))},n.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},n.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},n.normalize=function(){return this.divideScalar(this.length()||1)},n.setLength=function(t){return this.normalize().multiplyScalar(t)},n.lerp=function(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this},n.lerpVectors=function(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this.z=t.z+(n.z-t.z)*r,this},n.cross=function(t){return this.crossVectors(this,t)},n.crossVectors=function(t,n){var r=t.x,i=t.y,e=t.z,s=n.x,o=n.y,h=n.z;return this.x=i*h-e*o,this.y=e*s-r*h,this.z=r*o-i*s,this},n.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},n.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},n.fromArray=function(t,n){return void 0===n&&(n=0),this.x=t[n],this.y=t[n+1],this.z=t[n+2],this},n.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},t}(),Q=function(){function t(){this.pos=new D,this.dir=new D,this.right=new D,this.up=new D,this.dist=0,this.widthScale=1,this.sharp=!1}var n=t.prototype;return n.lerpPathPoints=function(t,n,r){this.pos.lerpVectors(t.pos,n.pos,r),this.dir.lerpVectors(t.dir,n.dir,r),this.up.lerpVectors(t.up,n.up,r),this.right.lerpVectors(t.right,n.right,r),this.dist=(n.dist-t.dist)*r+t.dist,this.widthScale=(n.widthScale-t.widthScale)*r+t.widthScale},n.copy=function(t){this.pos.copy(t.pos),this.dir.copy(t.dir),this.up.copy(t.up),this.right.copy(t.right),this.dist=t.dist,this.widthScale=t.widthScale},t}(),H=function(){function t(t,n,r,i,e,s,o,h,a,u,c,l,x,p,v,f){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,n,r,i,e,s,o,h,a,u,c,l,x,p,v,f)}var n=t.prototype;return n.set=function(t,n,r,i,e,s,o,h,a,u,c,l,x,p,v,f){var y=this.elements;return y[0]=t,y[4]=n,y[8]=r,y[12]=i,y[1]=e,y[5]=s,y[9]=o,y[13]=h,y[2]=a,y[6]=u,y[10]=c,y[14]=l,y[3]=x,y[7]=p,y[11]=v,y[15]=f,this},n.multiply=function(t){return this.multiplyMatrices(this,t)},n.makeRotationAxis=function(t,n){var r=Math.cos(n),i=Math.sin(n),e=1-r,s=t.x,o=t.y,h=t.z,a=e*s,u=e*o;return this.set(a*s+r,a*o-i*h,a*h+i*o,0,a*o+i*h,u*o+r,u*h-i*s,0,a*h-i*o,u*h+i*s,e*h*h+r,0,0,0,0,1),this},n.equals=function(t){for(var n=this.elements,r=t.elements,i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0},t}();function X(t,n){return X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},X(t,n)}function G(t,n,r,i){return function(t,n){var r=1-t;return r*r*n}(t,n)+function(t,n){return 2*(1-t)*t*n}(t,r)+function(t,n){return t*t*n}(t,i)}var J=function(t){var n,r;function i(n,r,i){var e;return void 0===n&&(n=new D),void 0===r&&(r=new D),void 0===i&&(i=new D),(e=t.call(this)||this).isQuadraticBezierCurve3=!0,e.type="QuadraticBezierCurve3",e.v0=n,e.v1=r,e.v2=i,e}return r=t,(n=i).prototype=Object.create(r.prototype),n.prototype.constructor=n,X(n,r),i.prototype.getPoint=function(t,n){void 0===n&&(n=new D);var r=n,i=this.v0,e=this.v1,s=this.v2;return r.set(G(t,i.x,e.x,s.x),G(t,i.y,e.y,s.y),G(t,i.z,e.z,s.z)),r},i}(function(){function t(){this.type="Curve",this.arcLengthDivisions=200}var n=t.prototype;return n.getPoint=function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},n.getPointAt=function(t,n){var r=this.getUtoTmapping(t);return this.getPoint(r,n)},n.getPoints=function(t){void 0===t&&(t=5);for(var n=[],r=0;r<=t;r++)n.push(this.getPoint(r/t));return n},n.getLength=function(){var t=this.getLengths();return t[t.length-1]},n.getLengths=function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var n,r=[],i=this.getPoint(0),e=0;r.push(0);for(var s=1;s<=t;s++)e+=(n=this.getPoint(s/t)).distanceTo(i),r.push(e),i=n;return this.cacheArcLengths=r,r},n.getUtoTmapping=function(t,n){var r,i=this.getLengths(),e=0,s=i.length;r=n||t*i[s-1];for(var o,h=0,a=s-1;h<=a;)if((o=i[e=Math.floor(h+(a-h)/2)]-r)<0)h=e+1;else{if(!(o>0)){a=e;break}a=e-1}if(i[e=a]===r)return e/(s-1);var u=i[e];return(e+(r-u)/(i[e+1]-u))/(s-1)},t}()),K=new D,Y=new D,$=new D,tt=new H,nt=new J;var rt=function(){function t(){this.array=[],this.count=0}var n=t.prototype;return n.set=function(t,n,r,i,e){if(void 0===n&&(n=.1),void 0===r&&(r=10),void 0===i&&(i=null),void 0===e&&(e=!1),(t=t.slice(0)).length<2)return console.warn("PathPointList: points length less than 2."),void(this.count=0);e&&!t[0].equals(t[t.length-1])&&t.push((new D).copy(t[0]));for(var s=0,o=t.length;s<o;s++)if(0===s)this._start(t[s],t[s+1],i);else if(s===o-1)if(e){this._corner(t[s],t[1],n,r,i);var h=this.array[0].dist;this.array[0].copy(this.array[this.count-1]),this.array[0].dist=h}else this._end(t[s]);else this._corner(t[s],t[s+1],n,r,i)},n.distance=function(){return this.count>0?this.array[this.count-1].dist:0},n._getByIndex=function(t){return this.array[t]||(this.array[t]=new Q),this.array[t]},n._start=function(t,n,r){this.count=0;var i=this._getByIndex(this.count);if(i.pos.copy(t),i.dir.subVectors(n,t),r)i.up.copy(r);else{var e=Number.MAX_VALUE,s=Math.abs(i.dir.x),o=Math.abs(i.dir.y),h=Math.abs(i.dir.z);s<e&&(e=s,i.up.set(1,0,0)),o<e&&(e=o,i.up.set(0,1,0)),h<e&&i.up.set(0,0,1)}i.right.crossVectors(i.dir,i.up).normalize(),i.up.crossVectors(i.right,i.dir).normalize(),i.dist=0,i.widthScale=1,i.sharp=!1,i.dir.normalize(),this.count++},n._end=function(t){var n=this.array[this.count-1],r=this._getByIndex(this.count);r.pos.copy(t),r.dir.subVectors(t,n.pos);var i=r.dir.length();r.dir.normalize(),r.up.copy(n.up);var e=K.crossVectors(n.dir,r.dir);if(e.length()>Number.EPSILON){e.normalize();var s=Math.acos(Math.min(Math.max(n.dir.dot(r.dir),-1),1));r.up.applyMatrix4(tt.makeRotationAxis(e,s))}r.right.crossVectors(r.dir,r.up).normalize(),r.dist=n.dist+i,r.widthScale=1,r.sharp=!1,this.count++},n._corner=function(t,n,r,i,e){if(r>0&&i>0){for(var s=function(t,n,r,i,e,s){var o=K.subVectors(n,t),h=Y.subVectors(r,n),a=o.length(),u=h.length();o.normalize(),h.normalize();var c=Math.min(.999999*(e?a/2:a),i);s.v0.copy(n).sub(o.multiplyScalar(c)),s.v1.copy(n);var l=Math.min(u/2*.999999,i);return s.v2.copy(n).add(h.multiplyScalar(l)),s}(this.array[this.count-1].pos,t,n,r,this.count-1==0,nt),o=s.getPoints(i),h=0;h<i;h++)this._sharpCorner(o[h],o[h+1],e,0===h?1:0);o[i].equals(n)||this._sharpCorner(o[i],n,e,2)}else this._sharpCorner(t,n,e,0,!0)},n._sharpCorner=function(t,n,r,i,e){void 0===i&&(i=0),void 0===e&&(e=!1);var s=this.array[this.count-1],o=this._getByIndex(this.count),h=K.subVectors(t,s.pos),a=Y.subVectors(n,t),u=h.length();if(h.normalize(),a.normalize(),o.pos.copy(t),1===i?o.dir.copy(h):2===i?o.dir.copy(a):(o.dir.addVectors(h,a),o.dir.normalize()),r)1===o.dir.dot(r)?o.right.crossVectors(a,r).normalize():o.right.crossVectors(o.dir,r).normalize(),o.up.crossVectors(o.right,o.dir).normalize();else{o.up.copy(s.up);var c=$.crossVectors(s.dir,o.dir);if(c.length()>Number.EPSILON){c.normalize();var l=Math.acos(Math.min(Math.max(s.dir.dot(o.dir),-1),1));o.up.applyMatrix4(tt.makeRotationAxis(c,l))}o.right.crossVectors(o.dir,o.up).normalize()}o.dist=s.dist+u;var x=h.dot(a);o.widthScale=Math.min(1/Math.sqrt((1+x)/2),1.415)||1,o.sharp=Math.abs(x-1)>.05&&e,this.count++},t}(),it=new D(0,0,1);t.cylinder=function(t,n){void 0===n&&(n={}),n=Object.assign({},{radius:1,height:2,radialSegments:6},n);for(var r=Math.round(Math.max(4,n.radialSegments)),i=n,e=i.radius,s=i.height,o=360/r/360*Math.PI*2,h=r+1,a=new Float32Array(3*h*2),u=t[0],c=t[1],l=0,x=0,p=3*h,v=2*h,f=[],y=[],d=-1;d<r;d++){var g=o*d,z=Math.cos(g)*e+u,m=Math.sin(g)*e+c;a[l]=z,a[l+1]=m,a[l+2]=0,a[l+p]=z,a[l+1+p]=m,a[l+2+p]=s;var M,w;M=.5+z/e/2,w=.5+m/e/2,y[x]=M,y[x+1]=w,y[x+v]=M,y[x+1+v]=w,l+=3,x+=2,d>1&&f.push(0,d-1,d)}a[l-=3]=a[0],a[l+1]=a[1],a[l+2]=a[2];var b=a.length;a[b-3]=a[0],a[b-2]=a[1],a[b-1]=s;for(var P=f.length,S=0;S<P;S++){var A=f[S];f.push(A+h)}var V=new Float32Array(2*(3*h*2-6)),Z=-1;l=2*h,x=0;for(var _=0,L=a.length/2;_<L-3;_+=3){var F=a[_],I=a[_+1],q=a[_+3],U=a[_+4];V[++Z]=F,V[++Z]=I,V[++Z]=s,V[++Z]=q,V[++Z]=U,V[++Z]=s,V[++Z]=F,V[++Z]=I,V[++Z]=0,V[++Z]=q,V[++Z]=U,V[++Z]=0;var j=l+2,C=l+3,T=l,k=l+1;f.push(T,j,k,j,C,k),l+=4;var B=x/h,R=(x+1)/h;y.push(B,s/e/2,R,s/e/2,B,0,R,0),x++}var E=new Float32Array(a.length+V.length);E.set(a,0),E.set(V,a.length);var N=O(f,E);return{points:a,indices:new Uint32Array(f),position:E,normal:N,uv:new Float32Array(y)}},t.expandLine=R,t.expandPaths=function(t,n){n=Object.assign({},{lineWidth:1,cornerRadius:0,cornerSplit:10},n);var r=t.map((function(t){var r=t.map((function(t){var n=t[0],r=t[1],i=t[2];return new D(n,r,i||0)})),i=new rt;i.set(r,n.cornerRadius,n.cornerSplit,it);var e=function(t,n){var r=n.lineWidth||.1,i=1,e=r/2,s=r,o=t.distance(),h=i*o;if(0===o)return null;var a,u=e/s,c=0,l=[],x=[],p=[],v=[],f=0,y=new D,d=new D,g=new D,z=new D,m=new D,M=new D;function w(t){var n=0===l.length,r=t.sharp&&!n,i=t.dist/s,o=t.dir,h=t.up,a=t.right;if(y.copy(a).multiplyScalar(e*t.widthScale),d.copy(a).multiplyScalar(-e*t.widthScale),y.add(t.pos),d.add(t.pos),r){g.fromArray(l,l.length-6).sub(d),z.fromArray(l,l.length-3).sub(y);var w,b,P=g.length()-z.length();P>0?(w=g,b=d):(w=z,b=y),m.copy(w).setLength(Math.abs(P)).add(b);var S=M.copy(b).sub(m).normalize().dot(o)*M.copy(b).sub(m).length()*2;M.copy(o).setLength(S).add(m),P>0?(l.push(m.x,m.y,m.z,y.x,y.y,y.z,d.x,d.y,d.z,y.x,y.y,y.z,M.x,M.y,M.z,y.x,y.y,y.z),f+=6,v.push(f-6,f-8,f-7,f-6,f-7,f-5,f-4,f-6,f-5,f-2,f-4,f-1),c+=12):(l.push(d.x,d.y,d.z,m.x,m.y,m.z,d.x,d.y,d.z,y.x,y.y,y.z,d.x,d.y,d.z,M.x,M.y,M.z),f+=6,v.push(f-6,f-8,f-7,f-6,f-7,f-5,f-6,f-5,f-3,f-2,f-3,f-1),c+=12),x.push(h.x,h.y,h.z,h.x,h.y,h.z,h.x,h.y,h.z,h.x,h.y,h.z,h.x,h.y,h.z,h.x,h.y,h.z),p.push(i-u,0,i-u,1,i,0,i,1,i+u,0,i+u,1)}else l.push(d.x,d.y,d.z,y.x,y.y,y.z),x.push(h.x,h.y,h.z,h.x,h.y,h.z),p.push(i,0,i,1),f+=2,n||(v.push(f-2,f-4,f-3,f-2,f-3,f-1),c+=6)}if(h>0)for(var b=0;b<t.count;b++){var P=t.array[b];if(P.dist>h){var S=t.array[b-1];a=new Q;var A=(h-S.dist)/(P.dist-S.dist);a.lerpPathPoints(S,P,A),w(a);break}w(P)}else a=t.array[0];return{points:l,normal:x,uvs:p,index:v,count:c}}(i,n);return e.line=t,e.position=new Float32Array(e.points),e.indices=new Uint32Array(e.index),e.uv=new Float32Array(e.uvs),e.normal=new Float32Array(e.normal),e})),i=I(r);return i.lines=t,i},t.extrudePolygons=function(t,n){n=Object.assign({},{depth:2},n);var r=t.map((function(t){for(var r=0,i=t.length;r<i;r++){var e=t[r];C(e),0===r?_(e)||(t[r]=e.reverse()):_(e)&&(t[r]=e.reverse()),T(e)&&e.splice(e.length-1,1)}var s=function(t,n){for(var r=function(t){var n=0,r=0,i=t.length;for(;r<i;)n+=t[r].length,r++;return n}(t),i=t.length,e=[],s=new Float32Array(2*r),o=[],h=[],a=3*r,u=2*r,c=n.depth,l=0,x=0,p=0,v=0;v<i;v++){var f=t[v];v>0&&e.push(l/2);for(var y=0,d=f.length;y<d;){var g=f[y],z=g[0],m=g[1];s[l++]=z,s[l++]=m,o[x]=z,o[x+1]=m,o[x+2]=c,o[a+x]=z,o[a+x+1]=m,o[a+x+2]=0,h[p]=z,h[p+1]=m,h[u+p]=z,h[u+p+1]=m,x+=3,p+=2,y++}}return{flatVertices:s,holes:e,points:o,count:r,uvs:h}}(t,n);return s.polygon=t,function(t,n){for(var r=[],i=t.count,e=0,s=n.length;e<s;e+=3){var o=n[e],h=n[e+1],a=n[e+2];r[e]=o,r[e+1]=h,r[e+2]=a;var u=s+e,c=i+o,l=i+h,x=i+a;r[u]=c,r[u+1]=l,r[u+2]=x}t.index=r}(s,Z(s.flatVertices,s.holes,2)),function(t,n){for(var r=t.points,i=t.index,e=t.polygon,s=t.uvs,o=n.depth,h=0,a=e.length;h<a;h++)for(var u=e[h],c=0,l=u.length;c<l;){var x=u[c],p=u[c+1];c===l-1&&(p=u[0]);var v=r.length/3,f=x[0],y=x[1],d=p[0],g=p[1];r.push(f,y,o,d,g,o,f,y,0,d,g,0);var z=v+2,m=v+3,M=v,w=v+1;i.push(z,M,m,M,w,m),j(s,r,z,m,M,w),c++}}(s,n),s.position=new Float32Array(s.points),s.indices=new Uint32Array(s.index),s.uv=new Float32Array(s.uvs),s.normal=O(s.indices,s.position),s})),i=I(r);return i.polygons=t,i},t.extrudePolylines=function(t,n){n=Object.assign({},{depth:2,lineWidth:1},n);var r=t.map((function(t){var r=R(t,n);return r.line=t,function(t,n){var r=n.depth,i=[],e=[],s=[],o=t.leftPoints,h=t.rightPoints,a=0,u=o.length;for(;a<u;){var c=3*a,l=o[a],x=l[0],p=l[1],v=l[2];i[c]=x,i[c+1]=p,i[c+2]=r+v;var f=h[a],y=f[0],d=f[1],g=f[2],z=3*u+c;i[z]=y,i[z+1]=d,i[z+2]=r+g;var m=2*u*3+c;i[m]=x,i[m+1]=p,i[m+2]=v;var M=2*u*3+3*u+c;i[M]=y,i[M+1]=d,i[M+2]=g,a++}a=0,u=i.length;for(;a<u;){var w=i[a],b=i[a+1];s.push(w,b),a+=3}a=0,u=o.length;for(;a<u-1;){var P=a,S=a+1,A=P+u,V=S+u;e.push(P,A,S),e.push(A,V,S);var Z=a+2*u,_=Z+1,L=Z+u,F=_+u;e.push(Z,L,_),e.push(L,F,_),a++}t.index=e,t.points=i,t.uvs=s}(r,n),function(t,n){var r=t.points,i=t.index,e=t.leftPoints,s=t.rightPoints,o=t.uvs,h=n.depth,a=[e,s];function u(t,n){var e=r.length/3;r.push(t[0],t[1],h+t[2],n[0],n[1],h+n[2],t[0],t[1],t[2],n[0],n[1],n[2]);var s=e+2,a=e+3,u=e,c=e+1;i.push(s,u,a,u,c,a),j(o,r,s,a,u,c)}for(var c=0,l=a.length;c<l;c++){var x=a[c];c>0&&(x=(x=x.map((function(t){return t}))).reverse());for(var p=0,v=x.length-1;p<v;){u(x[p],x[p+1]),p++}}for(var f=e.length,y=[s[0],e[0],e[f-1],s[f-1]],d=0;d<y.length;d+=2){u(y[d],y[d+1])}}(r,n),r.position=new Float32Array(r.points),r.indices=new Uint32Array(r.index),r.uv=new Float32Array(r.uvs),r.normal=O(r.indices,r.position),r})),i=I(r);return i.lines=t,i},Object.defineProperty(t,"__esModule",{value:!0})}));
